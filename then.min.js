/**
 * thenjs: v0.12.2
 * https://github.com/teambition/then.js
 */
!function(){"use strict";function a(a,b){var c=q.call(arguments,2);return function(){return a.apply(b,c.concat(q.call(arguments)))}}function b(a){return null==a}function c(a){return"function"==typeof a}function d(a,b,c){return c=c||"array",new Error("Argument "+(a&&a.toString())+' in "'+b+'" is not a '+c+"!")}function e(a,c,d,e){function f(f,g){return b(f)?(c[e]=g,--d.i<0&&a(null,c)):a(f)}return f._self=!0,f}function f(a,b,c){var f,g=[],h={};if(!s(b))return a(d(b,"each"));if(h.i=f=b.length-1,0>f)return a(null,g);for(var i=0;f>=i;i++)c(e(a,g,h,i),b[i],i,b)}function g(a,b){var c,f=[],g={};if(!s(b))return a(d(b,"parallel"));if(g.i=c=b.length-1,0>c)return a(null,f);for(var h=0;c>=h;h++)b[h](e(a,f,g,h),h,b)}function h(a,c,e){function f(d,j){return b(d)?(i[h]=j,++h>g?a(null,i):(r(function(){try{e(f,c[h],h,c)}catch(b){a(b)}}),void 0)):a(d)}var g,h=0,i=[];return f._self=!0,s(c)?(g=c.length-1,0>g?a(null,i):(e(f,c[h],h,c),void 0)):a(d(c,"eachSeries"))}function i(a,c){function e(d,i){return b(d)?(h[g]=i,++g>f?a(null,h):(r(function(){try{c[g](e,g,c)}catch(b){a(b)}}),void 0)):a(d)}var f,g=0,h=[];return e._self=!0,s(c)?(f=c.length-1,0>f?a(null,h):(c[g](e,g,c),void 0)):a(d(c,"series"))}function j(b,d){return c(d)?d._self?d:a(d,null,b):null}function k(){}function l(d){function e(){}function l(b,c){var d=new e,f=a(d._defer,d);return f._self=d,b(f,c),c&&(c._nextDefer=f,c._result&&c._defer.apply(c,c._result)),d}var m=e.prototype=new k,n=[],o=0;return m.constructor=e,(!d||c(d))&&(m.debug=d),c(p.onerror)||(p.onerror=null),m.all=function(a){return l(function(b,c){c._all=j(b,a)},this)},m.then=function(a,b){return l(function(c,d){d._success=j(c,a),d._error=j(c,b)},this)},m.fail=function(b){return l(function(c,d){d._fail=j(c,b),d._success=a(c,null,null),d._success._self=c._self,d._fail&&n.push(d._fail)},this)},m.each=function(a,b){return l(function(c,d){d._each=function(d,e){f(c,a||d,b||e)}},this)},m.eachSeries=function(a,b){return l(function(c,d){d._eachSeries=function(d,e){h(c,a||d,b||e)}},this)},m.parallel=function(a){return l(function(b,c){c._parallel=function(c){g(b,a||c)}},this)},m.series=function(a){return l(function(b,c){c._series=function(c){i(b,a||c)}},this)},m._defer=function(a){function c(){if(e)return e.apply(e._self,i);if(!b(a))throw a;g?g.apply(g._self,q.call(i,1)):h._result=i}function d(c){c.stack=c.stack||c.description,b(a)&&h._nextDefer?h._nextDefer(c):f||n.length?(f=f||n.shift(),f.call(f._self,c)):p.onerror?p.onerror(c):h._result=[c]}var e,f,g,h=this,i=arguments;if(h._result!==!1){h._result?h._result=!1:h.debug&&(o+=1,h.debug.apply(h.debug,["\nResult of chain "+o+": "].concat(q.call(i)))),e=h._all,f=h._fail?n.shift():h._error,g=h._success||h._each||h._eachSeries||h._parallel||h._series;try{c()}catch(j){d(j)}}},l}function m(a,b){r(function(){try{b()}catch(c){a(c)}})}function n(a){return function(b,c,d){return l(d)(function(d){m(d,function(){return a(d,b,c)})})}}function o(a){return function(b,c){return l(c)(function(c){m(c,function(){return a(c,b)})})}}function p(a,b){return l(b)(function(b){m(b,function(){return c(a)?a(b):b()})})}var q=[].slice,r="function"==typeof setImmediate?setImmediate:function(a){setTimeout(a,0)},s=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};k.prototype.debug="object"==typeof console&&function(){console.log.apply(console,arguments)},p.nextTick=function(a){r(a)},p.each=n(f),p.eachSeries=n(h),p.parallel=o(g),p.series=o(i),"object"==typeof module&&"object"==typeof module.exports?module.exports=p:"function"==typeof define&&define.amd?define([],function(){return p}):"object"==typeof window&&(window.thenjs=p)}();