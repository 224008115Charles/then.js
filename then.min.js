/**
 * thenjs: v0.11.0
 * https://github.com/teambition/then.js
 */
"use strict";!function(){function a(a){return null==a}function b(a){return"function"==typeof a}function c(a,b,c){return c=c||"function",new Error("Argument "+(a&&a.toString())+' in "'+b+'" is not a '+c+"!")}function d(d,e,f,g){function h(b,c,e){return a(c)?(l[b]=arguments.length>3?o.call(arguments,2):e,j-=1,0>j&&d(null,l)):d(c)}var i,j,k,l=[];if(!q(e))return d(c(e,"each","array"));if(!b(f))return d(c(f,"each"));if(j=i=e.length-1,0>j)return d(null,l);for(;i>=0;i--)k=h.bind(null,i),k._self=!0,f.call(g,k,e[i],i,e)}function e(d,e,f,g){function h(b,c){return a(b)?(k[j]=arguments.length>2?o.call(arguments,1):c,j+=1,j>i?d(null,k):f.call(g,h,e[j],j,e)):d(b)}var i,j=0,k=[];return q(e)?b(f)?(i=e.length-1,0>i?d(null,k):(h._self=!0,f.call(g,h,e[j],j,e),void 0)):d(c(f,"eachSeries")):d(c(e,"eachSeries","array"))}function f(d,e,f){function g(b,c,e){return a(c)?(l[b]=arguments.length>3?o.call(arguments,2):e,i-=1,0>i&&d(null,l)):d(c)}var h,i,j,k,l=[];if(!q(e))return d(c(e,"parallel","array"));if(i=h=e.length-1,0>i)return d(null,l);for(;h>=0;h--){if(k=e[h],!b(k))return d(c(k,"parallel"));j=g.bind(null,h),j._self=!0,k.call(f,j,h,e)}}function g(d,e,f){function g(l,m){return a(l)?(k[j]=arguments.length>2?o.call(arguments,1):m,j+=1,j>h?d(null,k):(i=e[j],b(i)?i.call(f,g,j,e):d(c(i,"series")))):d(l)}var h,i,j=0,k=[];return q(e)?(h=e.length-1,0>h?d(null,k):(i=e[j],g._self=!0,b(i)?i.call(f,g,j,e):d(c(i,"series")))):d(c(e,"series","array"))}function h(){}function i(a,b){p(function(){try{b()}catch(c){a(c)}})}function j(a,c){return b(c)?c._self?c:c.bind(null,a):null}function k(c){function i(){}function k(a,b){var c=new i,d=c._defer.bind(c);return d._self=c,a(d,b),b&&b._result&&b._defer.apply(b,b._result),c}var l=i.prototype=new h,m=[],p=0;return l.constructor=i,(!c||b(c))&&(l.debug=c),l.all=function(a){return k(function(b,c){c._all=j(b,a)},this)},l.then=function(a,b){return k(function(c,d){d._success=j(c,a),d._error=j(c,b)},this)},l.fail=function(a){return k(function(b,c){c._fail=j(b,a),c._success=b.bind(null,null),c._success._self=b._self,c._fail&&m.push(c._fail)},this)},l.each=function(a,b,c){return k(function(e,f){f._each=function(f,g,h){d(e,a||f,b||g,c||h)}},this)},l.eachSeries=function(a,b,c){return k(function(d,f){f._eachSeries=function(f,g,h){e(d,a||f,b||g,c||h)}},this)},l.parallel=function(a,b){return k(function(c,d){d._parallel=function(d,e){f(c,a||d,b||e)}},this)},l.series=function(a,b){return k(function(c,d){d._series=function(d,e){g(c,a||d,b||e)}},this)},l._defer=function(c){function d(){if(f)return f.apply(f._self,j);if(!a(c))throw c;h?h.apply(h._self,o.call(j,1)):i._result=j}function e(a){a.stack=a.stack||a.description,g||m.length?(g=g||m.shift(),g.call(g._self,a)):b(n.onerror)?n.onerror(a):i._result=j}var f,g,h,i=this,j=arguments;if(i._result!==!1){i._result?i._result=!1:i.debug&&(p+=1,i.debug.apply(i.debug,["\nResult of chain "+p+": "].concat(o.call(j)))),f=i._all,g=i._fail?m.shift():i._error,h=i._success||i._each||i._eachSeries||i._parallel||i._series;try{d()}catch(k){e(k)}}},k}function l(a){return function(b,c,d,e){return k(e)(function(e){i(e,a.bind(null,e,b,c,d))})}}function m(a){return function(b,c,d){return k(d)(function(d){i(d,a.bind(null,d,b,c))})}}function n(a,c,d){return k(d)(function(d){i(d,b(a)?a.bind(c,d):d)})}var o=[].slice,p="object"==typeof process&&process.nextTick?process.nextTick:setTimeout,q=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=o.call(arguments,1);return function(){return b.apply(a,c.concat(o.call(arguments)))}}),h.prototype.debug="object"==typeof console&&function(){console.log.apply(console,arguments)},n.constructor=h,n.each=l(d),n.eachSeries=l(e),n.parallel=m(f),n.series=m(g),"object"==typeof module&&"object"==typeof module.exports?module.exports=n:"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof window&&(window.then=n)}();